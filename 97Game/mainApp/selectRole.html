<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 101 Template</title>
    <!-- Bootstrap -->
    <link href="../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../style.css">
    <script src="../encode.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      .thumbnail{border:none;}
    </style>
  </head>
  <body class="selectRole-body">
    <!-- 我的个人新信息 -->
    <div class="modal fade bs-example-modal-sm" tabindex="-1" id="show_userMessage" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content" >
          <div class="container">
            <img src="../images/other/usermessage.jpg" alt="">
            <h3>个人信息</h3>
            <h5>VIP 等级：<span id="sql_V"></span></h5>
            <h5>账户余额：<span id="sql_acount"></span></h5>
            <h5>队伍体力：<span id="sql_power"></span></h5>
            <h5>队伍数量：<span id="sql_Team"></span></h5>
            <h5>队伍战力：<span id="sql_combat"></span></h5>
            <h5>获得称号：<span id="sql_title"></span></h5>
          </div>
        </div>
      </div>
    </div>
  
    <!-- 我的队伍 -->
    <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" id="show_userTeam" aria-labelledby="myLargeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content"  style="text-align: center;">
          <div class="row" id="all_userTeam">
            
          </div>
        </div>
      </div>
    </div>

    <!-- 我的角色碎片 -->
    <div class="modal fade bs-example-modal-lg" tabindex="-1" id="show_userChip" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content" style="text-align: center;">
          <div class="row" id="sql_showAllChip"></div>
        </div>
      </div>
    </div>

    <!-- 我的金币 -->
    <div class="modal fade bs-example-modal-sm" tabindex="-1" id="show_userGem" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content" style="text-align: center;">
          <div class="jumbotron" style="margin-bottom:0">
            <img src="../images/other/money.jpg" alt="">
            <p>账户余额：<span id="sql_showAllMoney"></span></p>
            <p><a class="btn btn-primary btn-lg" href="#" role="button">给账户加油</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- 针对没有角色的用户的一种提示 -->
    <div class="modal fade bs-example-modal-sm" tabindex="-1" id="no_role" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content" >
          <h3 style="text-align: center;color:green;font-weight: bold;">欢迎进入 QH97Game</h3>
          <h3 style="text-align: center;color:green;font-weight: bold;">您的队伍目前空无一人....</h3>
          <h3 style="text-align: center;color:green;font-weight: bold;">您可以选择喜欢的人物角色加入自己的阵营</h3>
          <!-- <h3 style="text-align: center;color:green;font-weight: bold;">开始战斗吧</h3> -->
          <div style="text-align: center;">
            <img src="../images/dongzhang/benpao.jpg" alt="">
          </div>
        </div>
      </div>
    </div>
    
    <!-- 购买成功后的提示 -->
    <div class="modal fade bs-example-modal-sm" tabindex="-1" id="myModal" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <h3 style="text-align: center;color:green;font-weight: bold;">恭喜成功添加!</h3>
          <img src="../images/caozhijin/xiaozhao.gif">
          <hr>
          <h1 style="text-align: right;">
            <button type="button" class="btn btn-primary" data-dismiss="modal" id="close_modal" style="margin-right: 20px;">关闭</button>
          </h1>
        </div>
      </div>
    </div>

    <div id="mainRole" class="selectRole-mainRole">
      <span class="glyphicon glyphicon-user" id="P_message" data-toggle="tooltip" data-placement="right" title="我的信息">
      </span>
      <span class="glyphicon glyphicon-flag" id="P_team" data-toggle="tooltip" data-placement="right" title="我的队伍">
      </span>
      <span class="glyphicon glyphicon-th" id="P_chip" data-toggle="tooltip" data-placement="right" title="我的碎片">
      </span>
      <span class="glyphicon glyphicon-usd" id="P_gem" data-toggle="tooltip" data-placement="right" title="我的金币">
      </span>
      <span class="glyphicon glyphicon-fire" id="P_battle" data-toggle="tooltip" data-placement="right" title="开始战斗">
      </span>
    </div>
    <div class="container" >
      
      <div class="row" style="margin-top:20px;">
        <!-- 安迪 -->
        <div class="col-sm-6 col-md-4 hasParent" id="1">
          <div class="thumbnail">
            <img src="../images/andi/andi.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>ANDY BOGARD</h3>
              <p>
                <h5>攻击：87</h5>
                <h5>防御：43</h5>
                <h5>生命值：560</h5>
                <h5>交易价：450</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button" >加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 坂崎良 -->
        <div class="col-sm-6 col-md-4 hasParent" id="2">
          <div class="thumbnail">
            <img src="../images/banqiliang/banqiliang.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>RYO SAKAZAKI</h3>
              <p>
                <h5>攻击：83</h5>
                <h5>防御：50</h5>
                <h5>生命值：660</h5>
                <h5>交易价：450</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 坂崎由莉 -->
        <div class="col-sm-6 col-md-4 hasParent" id="3">
          <div class="thumbnail">
            <img src="../images/banqiyouli/banqiyouli.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>YURI SAKAZAKI</h3>
              <p>
                <h5>攻击：85</h5>
                <h5>防御：47</h5>
                <h5>生命值：530</h5>
                <h5>交易价：450</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 蔡宝奇 -->
        <div class="col-sm-6 col-md-4 hasParent" id="4">
          <div class="thumbnail">
            <img src="../images/caibaoqi/caibaoqi.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>CHOI BOUNGE</h3>
              <p>
                <h5>攻击：88</h5>
                <h5>防御：43</h5>
                <h5>生命值：530</h5>
                <h5>交易价：450</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 陈可汉 -->
        <div class="col-sm-6 col-md-4 hasParent" id="5">
          <div class="thumbnail">
            <img src="../images/chengkehan/chengkehan.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>CHANG KOEHAN</h3>
              <p>
                <h5>攻击：75</h5>
                <h5>防御：56</h5>
                <h5>生命值：580</h5>
                <h5>交易价：1350</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 大门五郎 -->
        <div class="col-sm-6 col-md-4 hasParent" id="6">
          <div class="thumbnail">
            <img src="../images/damen/damen.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>GORO DAIMEN</h3>
              <p>
                <h5>攻击：78</h5>
                <h5>防御：55</h5>
                <h5>生命值：570</h5>
                <h5>交易价：1350</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>  
        <!-- 东丈 -->
        <div class="col-sm-6 col-md-4 hasParent" id="7">
          <div class="thumbnail">
            <img src="../images/dongzhang/dongzhang.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>JOE HIGASHI</h3>
              <p>
                <h5>攻击：86</h5>
                <h5>防御：48</h5>
                <h5>生命值：530</h5>
                <h5>交易价：1350</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 金家潘 -->
        <div class="col-sm-6 col-md-4 hasParent" id="8">
          <div class="thumbnail">
            <img src="../images/jinjiapan/jinjiapan.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>KIM KAPHWAN</h3>
              <p>
                <h5>攻击：80</h5>
                <h5>防御：45</h5>
                <h5>生命值：550</h5>
                <h5>交易价：1350</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 京 -->
        <div class="col-sm-6 col-md-4 hasParent" id="9">
          <div class="thumbnail">
            <img src="../images/jin/jin.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>KING</h3>
              <p>
                <h5>攻击：83</h5>
                <h5>防御：44</h5>
                <h5>生命值：540</h5>
                <h5>交易价：3150</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 克拉克 -->
        <div class="col-sm-6 col-md-4 hasParent" id="10">
          <div class="thumbnail">
            <img src="../images/kelake/kelake.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>CLARK</h3>
              <p>
                <h5>攻击：81</h5>
                <h5>防御：46</h5>
                <h5>生命值：560</h5>
                <h5>交易价：3150</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 拉尔夫 -->
        <div class="col-sm-6 col-md-4 hasParent" id="11">
          <div class="thumbnail">
            <img src="../images/laerfu/laerfu.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>RALF</h3>
              <p>
                <h5>攻击：83</h5>
                <h5>防御：45</h5>
                <h5>生命值：540</h5>
                <h5>交易价：3150</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 丽安娜 -->
        <div class="col-sm-6 col-md-4 hasParent" id="12">
          <div class="thumbnail">
            <img src="../images/lianna/lianna.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>LEONA</h3>
              <p>
                <h5>攻击：85</h5>
                <h5>防御：40</h5>
                <h5>生命值：560</h5>
                <h5>交易价：3150</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 雅典娜 -->
        <div class="col-sm-6 col-md-4 hasParent" id="13">
          <div class="thumbnail">
            <img src="../images/yadianna/yadianna.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>ATHENA ASAMIYA</h3>
              <p>
                <h5>攻击：88</h5>
                <h5>防御：39</h5>
                <h5>生命值：510</h5>
                <h5>交易价：4800</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 玛丽 -->
        <div class="col-sm-6 col-md-4 hasParent" id="14">
          <div class="thumbnail">
            <img src="../images/mali/mali.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>BIUE MARY</h3>
              <p>
                <h5>攻击：90</h5>
                <h5>防御：35</h5>
                <h5>生命值：500</h5>
                <h5>交易价：4800</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 特瑞 -->
        <div class="col-sm-6 col-md-4 hasParent" id="15">
          <div class="thumbnail">
            <img src="../images/terui/terui.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>TEERY BOGARD</h3>
              <p>
                <h5>攻击：83</h5>
                <h5>防御：46</h5>
                <h5>生命值：540</h5>
                <h5>交易价：4800</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 镇元斋 -->
        <div class="col-sm-6 col-md-4 hasParent" id="16">
          <div class="thumbnail">
            <img src="../images/zhengyuanzhai/zhengyuanzhai.jpg" class="img-responsive" alt="Responsive image">
            <div class="caption">
              <h3>CHIN GENTSAI</h3>
              <p>
                <h5>攻击：90</h5>
                <h5>防御：40</h5>
                <h5>生命值：520</h5>
                <h5>交易价：4800</h5>
              </p>
              <p>
                <a href="#" class="btn btn-primary Join_Team" role="button">加入队伍</a> 
              </p>
            </div>
          </div>
        </div>
        <!-- 提示 -->
        <!-- <div class="col-sm-6 col-md-4">
          <div class="thumbnail">
            <img src="../images/other/title.jpg" class="img-circle" alt="Responsive image">
            <div class="caption">
              <h3>其他人物正在开发中哦...</h3>
            </div>
          </div>
        </div> -->
      </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script>
      var user_location=window.location.search;
      var uName=hexToDec(user_location.substring(user_location.indexOf("_")+1));
      var data={"uName":uName}
      var hasCarId=[];

      //隐藏用户已有的人物
      $(document).ready(function(){
        $.ajax({
          type:"POST",
          data:data,
          url:"testUser.php",
          success:function(e){
            if(e=="error"){
              alert("迷之操作！！！请重新登录");
              window.location.href="http://localhost/QHgame/97Game";
            }
          },
          error:function(e){
            alert("迷之操作！！！请重新登录");
            window.location.href="http://localhost/QHgame/97Game";
          }
        })
        if(uName!=''){
          $.ajax({
            type:"POST",
            data:data,
            url :"selectRole.php",
            success:function(e){
              var carId=JSON.parse(e);
              if(carId.carid!=null){
                var allId=carId.carid.split(",");
                hasCarId=allId;
                if(hasCarId.length==1){
                  $("#no_role").modal();
                  return;
                }
                if(allId!=null){
                  for(var i=0;i<allId.length;i++){
                    $("#"+hasCarId[i]).remove();
                  }
                }
              }else{
                $("#no_role").modal();
              }
            },
            error:function(){
              alert("查询失败！请重新加入")
            }
          })
        }else{
          alert("登录跳转失败！请重新登录")
          window.location.href="http://localhost/QHgame/97Game";
        }  
      });
      //点击加入队伍按钮
      $(".Join_Team").on("click",function(e){
        e.preventDefault();
        JoinTeam.bind(this)();
      })
      function JoinTeam(){
        var joinCarId=$(this).parents(".hasParent")[0].id;
        if($.inArray(joinCarId,hasCarId)!=-1){
          alert("你已经拥有此人物，请不要重复添加")
        }else{
          var carid={"uName":uName,"carid":joinCarId};
          $.ajax({
            type:"POST",
            data:carid,
            url :"joinTeam.php",
            success:function(e){
              if(e=="success"){
                $('#myModal').modal()
                $("#close_modal").click(function(){
                  location.reload();
                })
              }else if(e=="NoMoeny"){
                alert("您的账户余额不足购买此人物")
              }else{
                alert("购买失败！")
              }
            },
            error:function(){
              alert("查询失败！请重新加入")
            }
          })
        }
      }

      //hover左边导航进行提示的信息
      $('#P_message').tooltip();
      $('#P_team').tooltip();
      $('#P_chip').tooltip();
      $('#P_gem').tooltip();
      $('#P_battle').tooltip();

      //点击导航展示详细的信息
      $("#P_message").click(function(){//个人信息
        $("#show_userMessage").modal();
        if(uName!=''){
          $.ajax({
            type:"POST",
            data:data,
            url :"sqlUserMessage.php",
            success:function(e){
              var allMessage=JSON.parse(e);
              if(allMessage.carid==null){
                $("#sql_Team").html();
              }else{
                var length=allMessage.carid.split(",").length;
                $("#sql_Team").html(parseInt(length)-1);
              }
              $("#sql_V").html(allMessage.user_v);
              $("#sql_power").html(allMessage.user_power);
              $("#sql_acount").html(allMessage.user_money);
              $("#sql_title").html(allMessage.user_title);
              $("#sql_combat").html(allMessage.user_combat);
            },
            error:function(){
              alert("查询失败！请重新查询")
            }
          })
        }else{
          alert("登录跳转失败！请重新登录")
          window.location.href="http://localhost/QHgame/97Game";
        }  
      })
      $("#P_team").click(function(){//个人队伍
        $("#show_userTeam").modal();
        var str='';
        if(uName!=''){
          $.ajax({
            type:"POST",
            data:data,
            url :"selectRole.php",
            success:function(e){
              var carId=JSON.parse(e);
              if(carId.carid!=null){
                var allId=carId.carid.split(",");
              }else{
                $("#all_userTeam").html("<img src='../images/other/nochip01.jpg'><h3>您当前还未添加任何人物...</h3>")
                return;
              }
              
              hasCarId=allId;
              if(allId.length==1){
                $("#all_userTeam").html("<img src='../images/other/nochip01.jpg'><h3>您当前还未添加任何人物...</h3>")
                return;
              }
              if(allId!=null){
                for(var i=0;i<allId.length;i++){
                  if(i!=0){
                    str+="<div class='col-sm-6 col-md-4'>"+
                            "<div class='thumbnail'>"+
                              "<img src='../images/showRole/"+allId[i]+".png'/>"+
                              "<div class='caption' style='text-align:left;'>"+
                                "<p>攻击力：789</p>"+
                                "<p>攻击力：789</p>"+
                                "<p>攻击力：789</p>"+
                              "</div>"+
                            "</div>"+
                          "</div>"
                  }
                }
                $("#all_userTeam").html("<h3>我的队伍信息</h3>"+str)
              }
            },
            error:function(){
              alert("查询失败！请重新查询")
            }
          })
        }else{
          alert("登录跳转失败！请重新登录")
          window.location.href="http://localhost/QHgame/97Game";
        }  

      })
      $("#P_chip").click(function(){//个人碎片
        $("#show_userChip").modal();
        if(uName!=''){
          $.ajax({
            type:"POST",
            data:data,
            url :"sqlMyChip.php",
            success:function(e){
              var sqlMyChip=JSON.parse(e);
              var allChip=sqlMyChip.message;//保存碎片的信息
              var str='';//保存展示的碎片的图片
              var objisNUll=true;
              for(var i=0;i<allChip.length;i++){
                if(allChip[i].rolechip!=null&&allChip[i].rolechip!=0){
                    objisNUll=false;
                    str+="<div class='col-sm-6 col-md-4' style='margin:0px'>"+
                          "<div class='thumbnail'>"+
                            "<img src='../images/showRole/"+allChip[i].roleid+".png'>"+
                            "<div class='caption'>"+
                              "<h3>碎片数量：<span id='"+allChip[i].roleid+"'>"+allChip[i].rolechip+"</span></h3>"+
                              "<p><a class='btn btn-primary intensify' role='button'>强化</a></p>"+
                            "</div>"+
                          "</div>"+
                          "</div>"
                }
              }
              if(objisNUll){
                str="<div class='jumbotron' style='margin-bottom:0'>"+
                        "<img src='../images/other/nochip01.jpg'>"+
                        "<h3>您目前还未获得任何碎片</h3>"+
                      "</div>"
              }
              $("#sql_showAllChip").html("<h3>我的碎片信息</h3>"+str);
              $(".intensify").on("click",function(e){
                e.preventDefault();
                var roleId=$(this).parent().siblings("h3").children()[0].id;
                var chipNum=$(this).parent().siblings("h3").children()[0].innerHTML;
                var data={"uName":uName,"roleid":roleId};
                $.ajax({
                  type:"POST",
                  data:data,
                  url :"intensify.php",
                  success:function(e){
                    if(e=="success"){
                      alert("强化成功!");
                      location.reload();
                    }
                  },
                  error:function(e){}
                })
              })
            },
            error:function(){
              alert("查询失败！请重新查询")
            }
          })
        }else{
          alert("登录跳转失败！请重新登录")
          window.location.href="http://localhost/QHgame/97Game";
        }  
      })

      $("#P_gem").click(function(){//个人金币
        $("#show_userGem").modal();
        if(uName!=''){
          $.ajax({
            type:"POST",
            data:data,
            url :"sqlUserMessage.php",
            success:function(e){
              var sqlMyMoney=JSON.parse(e);
              if(sqlMyMoney.user_money!=null){
                $("#sql_showAllMoney").html(sqlMyMoney.user_money);
              }else{
                 $("#sql_showAllMoney").html(0);
              }
              
            },
            error:function(){
              alert("查询失败！请重新查询")
            }
          })
        }else{
          alert("登录跳转失败！请重新登录")
          window.location.href="http://localhost/QHgame/97Game";
        }  
      });
      $("#P_battle").click(function(){//进入选择战斗模式
        window.location.href="http://localhost/QHgame/97Game/mainApp/selectModal.html?UFO"+Math.ceil(Math.random()*520)+'_'+decToHex(uName);
      })


    </script>
  </body>
</html>